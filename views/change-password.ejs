<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>修改密碼 - TaskFlow</title>
  <style>
    body {font-family: Arial, sans-serif;background: #f0f2f5;display: flex;justify-content: center;align-items: center;height: 100vh;margin: 0;}
    .card {background: white;padding: 40px;border-radius: 15px;box-shadow: 0 10px 30px rgba(0,0,0,0.15);width: 420px;}
    h1 {text-align: center;color: #007bff;margin-bottom: 10px;}
    p {text-align: center;color: #666;margin-bottom: 30px;}
    input {width: 100%;padding: 14px;margin: 12px 0;border: 1px solid #ddd;border-radius: 8px;box-sizing: border-box;font-size: 16px;}
    button {width: 100%;padding: 14px;background: #007bff;color: white;border: none;border-radius: 8px;font-size: 16px;cursor: pointer;margin-top: 10px;}
    button:hover {background: #0056b3;}
    .error {color: #dc3545;text-align: center;margin: 15px 0;padding: 12px;background: #ffebee;border-radius: 8px;font-weight: bold;}
    .links {text-align: center;margin-top: 25px;}
    .links a {color: #007bff;text-decoration: none;margin: 0 15px;}
    .links a:hover {text-decoration: underline;}
  </style>
</head>
<body>
  <div class="card">
    <h1>修改密碼</h1>
    <p>帳號：<%= user.username %></p>

    <!-- 這裡一定要加 = 號，不然 error 變數會 undefined！ -->
    <% if (typeof error !== 'undefined') { %>
      <div class="error"><%= error %></div>
    <% } %>

    <form method="POST" action="/auth/change-password">
      <input type="password" name="oldPassword" placeholder="請輸入舊密碼" required>
      <input type="password" name="newPassword" placeholder="請輸入新密碼（至少6個字）" required minlength="6">
      <input type="password" name="confirmPassword" placeholder="再次輸入新密碼" required minlength="6">
      <button type="submit">確認修改</button>
    </form>

    <div class="links">
      <a href="/tasks">回任務列表</a>
      <% if (user.username === 'admin') { %>
        | <a href="/admin">管理員面板</a>
      <% } %>
    </div>
  </div>
</body>
</html>